<?php 
    $pergunta = "";
    $resposta1 = "";
    $resposta2 = "";
    $resposta3 = "";
    $multipla = "";
    $id = "";

    if($_SERVER["REQUEST_METHOD"] == "GET"){
        $pergunta = $_GET["pergunta"];
        $resposta1 = $_GET["resposta1"];
        $resposta2 = $_GET["resposta2"];
        $resposta3 = $_GET["resposta3"];
        $id = $_GET["id"];

        if(!file_exists("perguntasRespostas.txt")){
                $arqPerg = fopen("perguntasRespostas.txt", "w") or die("erro ao criar arquivo");
                if($resposta1 == ""){
                    $linha = $id. ";" . "-1". "\n" . $id . ";" . $pergunta;
                }else{
                    $linha = $id. ";". $pergunta . "\n" . $id .";".$resposta1 . ";" . $resposta2 . ";" . $resposta3;
                }
        }else{
            $arqPerg = fopen("perguntasRespostas.txt", "a");
            if($resposta1 == ""){
                $linha = "\n". $id. ";" . "-1". "\n" . $id. ";" . $pergunta;
            }else{
                $linha = "\n". $id. ";" . $pergunta . "\n" . $id .";".$resposta1 . ";" . $resposta2 . ";" . $resposta3;
            }
        }
            fwrite($arqPerg, $linha);
            fclose($arqPerg);

        header("location: /3DAW/3DAW/3DAW-AV1/index.php");
        exit;
        
    }

        
?>

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <script>
        function criarPergunta(){
            let objForm = document.getElementById("formPergunta");
            let pergunta = document.getElementById("pergunta").value;
            let resposta1 = document.getElementById("resposta1").value;
            let resposta2 = document.getElementById("resposta2").value;
            let resposta3 = document.getElementById("resposta3").value;
            let multipla = "";
            let id = document.getElementById("id").value;

            let objJson = JSON.stringify(objForm);
            console.log("JSON: " + objJson);

            let xmlhttp = new XMLHttpRequest();
            console.log("1");
            xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                console.log("Chegou a resposta OK: " + this.responseText);
                console.log("2");
                document.getElementById("msg").innerHTML = this.responseText;
            } else if (this.readyState < 4) {
                console.log("3: " + this.readyState);
            } else
                console.log("Requisicao falhou: " + this.status);
            }
                console.log("4");
                xmlhttp.open("GET", "http://localhost/3DAW/3DAW/3DAW-AV1/criarPergunta.php?id=" + id);
                xmlhttp.send();
                console.log("enviei form");
                console.log("5");
        }
    </script>
    <title>Criar Perguntas</title>
</head>
<body>
    <form action="" method="POST" id="formPergunta">
        <h1>Crie sua pergunta</h1>
        <label for="">Digite o id: </label>
        <br>
        <input type="text" name="id" id="id">
        <br><br>
        <label for="">Digite sua pergunta</label>
        <br>
        <input type="text" name="pergunta" id="pergunta">
        <br><br>
        <label for="">Gostaria que ela fosse discursiva? </label>
        <br>
        <input type="radio" name="resposta" value="sim">Sim
        <br>
        <input type="radio" name="resposta" value="nao">NÃ£o
        <br><br>
        
        <label for="">Digite a primeira resposta: </label>
        <br>
        <input type="text" name="resposta1" id="resposta1">
        <br><br>
        <label for="">Digite a segunda resposta: </label>
        <br>
        <input type="text" name="resposta2" id="resposta2"> 
        <br><br>
        <label for="">Digite a terceira resposta: </label>
        <br>
        <input type="text" name="resposta3" id="resposta3">
        <br><br>
        <input class="botao-perguntas" type="submit" onclick="criarPergunta();">
    </form>
</body>
</html>